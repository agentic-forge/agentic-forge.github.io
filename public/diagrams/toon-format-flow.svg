<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 280">
  <defs>
    <marker id="toon-arr" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#8b5cf6"/>
    </marker>
    <marker id="toon-arr-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#10b981"/>
    </marker>
    <marker id="toon-arr-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="280" fill="none"/>

  <!-- Title -->
  <text x="400" y="25" text-anchor="middle" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0">TOON Format Flow</text>

  <!-- Row labels -->
  <text x="20" y="75" font-family="system-ui, sans-serif" font-size="10" fill="#94a3b8">Request</text>
  <text x="20" y="195" font-family="system-ui, sans-serif" font-size="10" fill="#94a3b8">Response</text>

  <!-- forge-ui -->
  <rect x="60" y="50" width="110" height="60" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="115" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#93c5fd">forge-ui</text>
  <text x="115" y="90" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#64748b">TOON toggle</text>
  <text x="115" y="102" text-anchor="middle" font-family="monospace" font-size="7" fill="#60a5fa">use_toon: true</text>

  <!-- Arrow 1 -->
  <line x1="170" y1="80" x2="210" y2="80" stroke="#8b5cf6" stroke-width="2" marker-end="url(#toon-arr)"/>

  <!-- forge-orchestrator -->
  <rect x="220" y="45" width="150" height="70" rx="6" fill="#1e1b4b" stroke="#8b5cf6" stroke-width="2"/>
  <text x="295" y="67" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#c4b5fd">forge-orchestrator</text>
  <text x="295" y="85" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#a5b4fc">sets custom header</text>
  <rect x="235" y="92" width="120" height="16" rx="3" fill="#312e81"/>
  <text x="295" y="104" text-anchor="middle" font-family="monospace" font-size="7" fill="#fcd34d">X-Prefer-Format: toon</text>

  <!-- Arrow 2 -->
  <line x1="370" y1="80" x2="410" y2="80" stroke="#8b5cf6" stroke-width="2" marker-end="url(#toon-arr)"/>
  <text x="390" y="70" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#94a3b8">MCP</text>

  <!-- forge-armory -->
  <rect x="420" y="45" width="150" height="70" rx="6" fill="#1e1b4b" stroke="#8b5cf6" stroke-width="2.5"/>
  <text x="495" y="67" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#c4b5fd">forge-armory</text>
  <text x="495" y="85" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#a5b4fc">reads header, routes</text>
  <text x="495" y="100" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#64748b">to backend server</text>

  <!-- Arrow 3 -->
  <line x1="570" y1="80" x2="610" y2="80" stroke="#f59e0b" stroke-width="2" marker-end="url(#toon-arr-orange)"/>
  <text x="590" y="70" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#94a3b8">MCP</text>

  <!-- MCP Server -->
  <rect x="620" y="50" width="110" height="60" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1.5"/>
  <text x="675" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#a7f3d0">MCP Server</text>
  <text x="675" y="90" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#6ee7b7">weather, search...</text>
  <text x="675" y="102" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#64748b">returns JSON</text>

  <!-- Response flow - bottom row -->

  <!-- MCP Server response -->
  <rect x="620" y="165" width="110" height="50" rx="6" fill="#064e3b" stroke="#10b981" stroke-width="1.5"/>
  <text x="675" y="185" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#a7f3d0">JSON Result</text>
  <text x="675" y="200" text-anchor="middle" font-family="monospace" font-size="7" fill="#64748b">{"temp": 22, ...}</text>

  <!-- Arrow back to Armory -->
  <line x1="620" y1="190" x2="580" y2="190" stroke="#10b981" stroke-width="2" marker-end="url(#toon-arr-green)"/>

  <!-- Armory conversion -->
  <rect x="420" y="155" width="150" height="70" rx="6" fill="#1e1b4b" stroke="#8b5cf6" stroke-width="2.5"/>
  <text x="495" y="177" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#c4b5fd">TOON Conversion</text>
  <text x="495" y="195" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#a5b4fc">to_toon(data)</text>
  <rect x="435" y="202" width="120" height="16" rx="3" fill="#312e81"/>
  <text x="495" y="214" text-anchor="middle" font-family="monospace" font-size="7" fill="#22d3ee">temp|humidity|...</text>

  <!-- Arrow back to Orchestrator -->
  <line x1="420" y1="190" x2="380" y2="190" stroke="#10b981" stroke-width="2" marker-end="url(#toon-arr-green)"/>
  <text x="400" y="180" text-anchor="middle" font-family="system-ui, sans-serif" font-size="7" fill="#94a3b8">TOON</text>

  <!-- Orchestrator response -->
  <rect x="220" y="165" width="150" height="50" rx="6" fill="#1e1b4b" stroke="#8b5cf6" stroke-width="2"/>
  <text x="295" y="185" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#c4b5fd">Passes through</text>
  <text x="295" y="200" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#a5b4fc">to UI as string</text>

  <!-- Arrow back to UI -->
  <line x1="220" y1="190" x2="180" y2="190" stroke="#10b981" stroke-width="2" marker-end="url(#toon-arr-green)"/>

  <!-- UI display -->
  <rect x="60" y="165" width="110" height="50" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="115" y="185" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#93c5fd">Displays TOON</text>
  <text x="115" y="200" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#60a5fa">with line breaks</text>

  <!-- Note about why X-Prefer-Format -->
  <rect x="60" y="240" width="680" height="28" rx="4" fill="#1e1b4b" stroke="#64748b" stroke-width="1" stroke-dasharray="4,2"/>
  <text x="400" y="258" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#94a3b8">Note: We use X-Prefer-Format instead of Accept header because MCP SDK overwrites Accept with "application/json"</text>
</svg>
